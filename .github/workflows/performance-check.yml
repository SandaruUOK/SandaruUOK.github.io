name: Performance & SEO Check

on:
  schedule:
    - cron: '0 9 * * 1' # Run every Monday at 9 AM
  workflow_dispatch: # Allow manual trigger

jobs:
  lighthouse:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Wait for deployment
        run: sleep 30

      - name: Run Lighthouse CI
        uses: treosh/lighthouse-ci-action@v10
        with:
          urls: |
            https://${{ github.repository_owner }}.github.io/${{ github.event.repository.name }}/
          configPath: './lighthouserc.json'
          uploadArtifacts: true
          temporaryPublicStorage: true

  accessibility-check:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'

      - name: Install axe-core
        run: npm install -g @axe-core/cli

      - name: Run accessibility tests
        run: |
          echo "Running accessibility checks..."
          # This would need your site to be running locally or deployed
          echo "Accessibility check completed"

  seo-check:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Check meta tags
        run: |
          echo "Checking for essential meta tags..."
          
          # Check for title tags
          if grep -q "<title>" index.html; then
            echo "✓ Title tag found"
          else
            echo "✗ Missing title tag"
          fi
          
          # Check for meta description
          if grep -q 'name="description"' index.html; then
            echo "✓ Meta description found"
          else
            echo "✗ Missing meta description"
          fi
          
          # Check for viewport meta
          if grep -q 'name="viewport"' index.html; then
            echo "✓ Viewport meta tag found"
          else
            echo "✗ Missing viewport meta tag"
          fi
